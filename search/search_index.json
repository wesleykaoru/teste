{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"baixas_em_banco_correspondente/","text":"Operacoes Atualiza Sinopse ' Atualiza a Sinopse Cont\u00e1bil Al\u00e7adas de Desconto TABELA CAMPO NOME a a a a a a a a a a a Consulta Trilha de Auditoria Agendamento de Di\u00e1rias a a a a a a a a a a a a Relat\u00f3rios da Di\u00e1ria","title":"Baixas em banco correspondente"},{"location":"baixas_em_banco_correspondente/#operacoes","text":"","title":"Operacoes"},{"location":"baixas_em_banco_correspondente/#atualiza-sinopse","text":"' Atualiza a Sinopse Cont\u00e1bil","title":"Atualiza Sinopse"},{"location":"baixas_em_banco_correspondente/#alcadas-de-desconto","text":"TABELA CAMPO NOME a a a a a a a a a a a","title":"Al\u00e7adas de Desconto"},{"location":"baixas_em_banco_correspondente/#consulta-trilha-de-auditoria","text":"","title":"Consulta Trilha de Auditoria"},{"location":"baixas_em_banco_correspondente/#agendamento-de-diarias","text":"a a a a a a a a a a a a","title":"Agendamento de Di\u00e1rias"},{"location":"baixas_em_banco_correspondente/#relatorios-da-diaria","text":"","title":"Relat\u00f3rios da Di\u00e1ria"},{"location":"configuracao_texto_padrao/","text":"Padr\u00e3o de configura\u00e7\u00f5es de texto Tipo Padr\u00e3o Vari\u00e1vel intAceitos Atributo [teste] Sub-rotina CalculaBaixas Tabela de banco de dados MovimentoDiarioEspecial Campo de banco de dados DataPagamento Funcao [ LiquidaContrato() ] Objeto clsCalculaParcelas Markdown | Vari\u00e1vel | *`intAceitos`* | | Atributo | [teste] | | Sub-rotina | **CalculaBaixas** | | Tabela de banco de dados | **`MovimentoDiarioEspecial`** | | Campo de banco de dados | `DataPagamento` | | Funcao | [*LiquidaContrato()*] | | Objeto | **clsCalculaParcelas** |","title":"Configura\u00e7\u00e3o de textos"},{"location":"configuracao_texto_padrao/#padrao-de-configuracoes-de-texto","text":"Tipo Padr\u00e3o Vari\u00e1vel intAceitos Atributo [teste] Sub-rotina CalculaBaixas Tabela de banco de dados MovimentoDiarioEspecial Campo de banco de dados DataPagamento Funcao [ LiquidaContrato() ] Objeto clsCalculaParcelas","title":"Padr\u00e3o de configura\u00e7\u00f5es de texto"},{"location":"configuracao_texto_padrao/#markdown","text":"| Vari\u00e1vel | *`intAceitos`* | | Atributo | [teste] | | Sub-rotina | **CalculaBaixas** | | Tabela de banco de dados | **`MovimentoDiarioEspecial`** | | Campo de banco de dados | `DataPagamento` | | Funcao | [*LiquidaContrato()*] | | Objeto | **clsCalculaParcelas** |","title":"Markdown"},{"location":"executa_baixas_de_parcelas - Copy (10)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (10)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (10)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (10)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (10)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (10)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (10)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (10)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (10)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (10)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (10)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (10)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (10)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (10)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (10)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (10)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (10)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (10)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (11)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (11)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (11)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (11)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (11)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (11)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (11)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (11)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (11)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (11)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (11)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (11)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (11)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (11)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (11)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (11)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (11)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (11)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (12)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (12)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (12)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (12)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (12)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (12)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (12)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (12)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (12)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (12)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (12)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (12)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (12)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (12)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (12)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (12)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (12)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (12)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (13)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (13)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (13)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (13)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (13)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (13)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (13)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (13)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (13)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (13)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (13)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (13)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (13)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (13)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (13)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (13)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (13)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (13)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (14)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (14)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (14)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (14)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (14)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (14)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (14)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (14)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (14)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (14)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (14)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (14)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (14)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (14)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (14)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (14)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (14)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (14)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (15)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (15)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (15)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (15)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (15)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (15)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (15)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (15)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (15)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (15)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (15)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (15)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (15)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (15)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (15)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (15)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (15)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (15)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (16)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (16)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (16)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (16)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (16)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (16)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (16)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (16)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (16)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (16)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (16)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (16)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (16)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (16)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (16)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (16)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (16)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (16)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (17)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (17)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (17)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (17)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (17)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (17)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (17)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (17)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (17)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (17)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (17)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (17)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (17)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (17)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (17)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (17)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (17)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (17)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (18)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (18)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (18)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (18)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (18)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (18)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (18)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (18)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (18)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (18)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (18)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (18)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (18)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (18)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (18)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (18)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (18)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (18)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (19)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (19)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (19)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (19)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (19)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (19)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (19)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (19)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (19)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (19)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (19)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (19)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (19)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (19)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (19)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (19)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (19)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (19)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (2)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (2)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (2)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (2)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (2)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (2)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (2)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (2)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (2)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (2)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (2)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (2)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (2)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (2)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (2)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (2)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (2)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (2)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (20)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (20)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (20)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (20)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (20)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (20)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (20)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (20)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (20)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (20)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (20)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (20)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (20)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (20)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (20)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (20)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (20)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (20)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (21)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (21)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (21)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (21)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (21)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (21)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (21)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (21)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (21)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (21)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (21)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (21)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (21)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (21)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (21)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (21)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (21)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (21)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (22)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (22)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (22)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (22)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (22)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (22)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (22)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (22)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (22)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (22)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (22)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (22)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (22)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (22)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (22)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (22)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (22)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (22)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (23)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (23)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (23)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (23)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (23)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (23)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (23)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (23)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (23)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (23)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (23)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (23)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (23)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (23)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (23)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (23)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (23)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (23)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (24)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (24)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (24)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (24)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (24)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (24)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (24)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (24)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (24)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (24)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (24)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (24)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (24)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (24)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (24)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (24)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (24)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (24)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (25)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (25)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (25)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (25)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (25)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (25)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (25)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (25)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (25)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (25)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (25)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (25)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (25)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (25)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (25)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (25)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (25)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (25)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (26)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (26)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (26)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (26)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (26)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (26)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (26)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (26)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (26)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (26)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (26)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (26)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (26)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (26)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (26)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (26)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (26)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (26)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (27)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (27)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (27)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (27)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (27)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (27)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (27)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (27)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (27)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (27)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (27)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (27)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (27)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (27)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (27)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (27)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (27)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (27)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (28)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (28)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (28)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (28)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (28)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (28)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (28)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (28)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (28)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (28)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (28)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (28)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (28)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (28)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (28)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (28)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (28)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (28)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (29)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (29)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (29)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (29)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (29)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (29)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (29)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (29)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (29)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (29)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (29)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (29)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (29)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (29)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (29)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (29)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (29)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (29)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (3)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (3)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (3)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (3)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (3)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (3)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (3)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (3)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (3)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (3)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (3)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (3)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (3)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (3)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (3)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (3)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (3)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (3)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (30)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (30)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (30)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (30)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (30)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (30)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (30)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (30)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (30)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (30)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (30)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (30)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (30)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (30)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (30)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (30)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (30)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (30)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (31)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (31)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (31)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (31)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (31)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (31)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (31)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (31)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (31)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (31)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (31)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (31)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (31)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (31)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (31)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (31)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (31)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (31)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (32)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (32)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (32)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (32)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (32)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (32)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (32)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (32)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (32)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (32)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (32)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (32)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (32)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (32)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (32)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (32)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (32)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (32)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (33)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (33)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (33)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (33)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (33)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (33)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (33)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (33)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (33)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (33)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (33)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (33)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (33)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (33)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (33)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (33)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (33)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (33)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (34)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (34)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (34)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (34)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (34)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (34)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (34)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (34)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (34)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (34)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (34)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (34)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (34)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (34)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (34)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (34)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (34)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (34)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (35)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (35)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (35)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (35)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (35)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (35)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (35)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (35)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (35)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (35)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (35)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (35)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (35)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (35)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (35)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (35)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (35)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (35)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (36)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (36)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (36)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (36)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (36)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (36)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (36)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (36)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (36)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (36)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (36)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (36)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (36)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (36)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (36)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (36)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (36)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (36)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (37)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (37)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (37)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (37)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (37)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (37)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (37)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (37)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (37)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (37)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (37)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (37)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (37)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (37)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (37)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (37)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (37)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (37)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (38)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (38)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (38)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (38)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (38)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (38)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (38)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (38)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (38)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (38)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (38)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (38)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (38)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (38)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (38)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (38)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (38)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (38)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (39)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (39)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (39)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (39)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (39)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (39)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (39)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (39)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (39)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (39)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (39)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (39)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (39)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (39)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (39)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (39)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (39)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (39)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (4)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (4)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (4)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (4)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (4)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (4)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (4)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (4)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (4)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (4)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (4)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (4)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (4)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (4)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (4)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (4)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (4)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (4)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (40)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (40)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (40)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (40)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (40)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (40)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (40)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (40)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (40)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (40)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (40)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (40)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (40)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (40)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (40)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (40)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (40)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (40)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (41)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (41)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (41)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (41)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (41)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (41)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (41)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (41)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (41)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (41)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (41)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (41)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (41)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (41)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (41)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (41)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (41)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (41)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (42)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (42)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (42)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (42)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (42)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (42)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (42)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (42)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (42)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (42)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (42)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (42)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (42)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (42)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (42)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (42)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (42)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (42)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (43)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (43)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (43)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (43)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (43)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (43)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (43)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (43)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (43)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (43)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (43)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (43)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (43)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (43)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (43)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (43)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (43)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (43)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (44)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (44)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (44)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (44)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (44)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (44)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (44)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (44)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (44)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (44)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (44)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (44)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (44)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (44)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (44)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (44)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (44)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (44)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (45)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (45)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (45)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (45)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (45)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (45)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (45)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (45)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (45)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (45)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (45)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (45)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (45)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (45)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (45)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (45)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (45)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (45)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (46)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (46)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (46)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (46)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (46)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (46)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (46)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (46)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (46)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (46)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (46)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (46)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (46)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (46)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (46)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (46)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (46)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (46)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (47)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (47)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (47)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (47)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (47)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (47)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (47)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (47)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (47)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (47)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (47)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (47)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (47)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (47)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (47)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (47)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (47)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (47)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (5)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (5)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (5)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (5)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (5)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (5)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (5)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (5)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (5)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (5)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (5)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (5)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (5)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (5)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (5)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (5)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (5)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (5)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (6)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (6)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (6)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (6)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (6)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (6)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (6)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (6)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (6)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (6)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (6)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (6)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (6)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (6)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (6)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (6)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (6)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (6)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (7)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (7)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (7)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (7)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (7)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (7)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (7)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (7)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (7)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (7)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (7)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (7)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (7)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (7)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (7)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (7)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (7)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (7)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (8)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (8)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (8)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (8)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (8)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (8)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (8)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (8)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (8)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (8)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (8)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (8)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (8)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (8)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (8)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (8)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (8)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (8)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy (9)/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (9)/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy (9)/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy (9)/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy (9)/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy (9)/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (9)/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy (9)/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy (9)/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy (9)/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy (9)/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy (9)/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy (9)/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy (9)/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy (9)/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy (9)/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy (9)/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy (9)/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas - Copy/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas - Copy/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas - Copy/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas - Copy/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas - Copy/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas - Copy/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas - Copy/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas - Copy/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas - Copy/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas - Copy/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas - Copy/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas - Copy/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas - Copy/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas - Copy/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas - Copy/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas - Copy/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas - Copy/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas - Copy/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas - Copy/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"executa_baixas_de_parcelas/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Executa Baixas de Parcelas"},{"location":"executa_baixas_de_parcelas/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"liquida_contrato/","text":"Fun\u00e7\u00e3o - LiquidaContrato() Prop\u00f3sito Realizar a liquida\u00e7\u00e3o das parcelas do contrato. Input Nulo Output Nulo Descri\u00e7\u00e3o t\u00e9cnica Func - 1.0.0- Cria uma consulta na tabela Parcelas selecionando o campo Parcela , e soma os campos Principal , Receita , ReceitaAtraso para criar 'Saldo'. Filtra pelos campos Empresa , Agencia , Contrato e Situacao igual a 'A'. Func - 1.0.1- Realiza a execu\u00e7\u00e3o da consulta Func -1.0.0 e verifica se existem dados, caso n\u00e3o haja, salva a mensagem 'Contrato n\u00e3o possui parcelas abertas!' na vari\u00e1vel LiquidaContrato e encerra a fun\u00e7\u00e3o [ LiquidaContrato() ]. Func - 1.0.2- Caso haja dados na consulta de Func - 1.0.1, percorre os valores e atribui os valores para o vetor strParcelas , e incrementa a vari\u00e1vel IntParcelas . Divide os valores proporcionalmente Func - 1.0.3- Verifica o tamanho da vari\u00e1vel IntParcelas , enquanto n\u00e3o percorrer a o \u00faltimo valor, preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: vetor strParcelas posi\u00e7\u00e3o 2, dividido pela vari\u00e1vel dblTotalParcelas e multiplicado pela vari\u00e1vel dblValorPago . Caso seja a \u00faltima posi\u00e7\u00e3o preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: a vari\u00e1vel dblValorPago menos a vari\u00e1vel dblValorAcumulado . Func - 1.0.4- A vari\u00e1vel dblValorAcumulado recebe ela mais o valor da posi\u00e7\u00e3o 3 do vetor strParcelas . Trata a liquida\u00e7\u00e3o do Contrato Func - 1.0.5- Cria o objeto clsCalculaParcelas usando a classe CalculaParcelas e preenche atributos: [strContrato],[strAgencia],[strParcela],[varDataPagamento],[varDataMovimento],[intAbreTransacao],[strUsuarioAtivo] com valores de vari\u00e1veis. Func - 1.0.6- Verifica se a vari\u00e1vel strClienteSicred \u00e9 igual a \"SULFINANCEIRA\" ou \"MATONE\", se sim, aplica ao atributo [strAceitaDesconto] o valor de 'S' e 'N' respectivamente. Func - 1.0.7- Verifica se a vari\u00e1vel ................................. Fun\u00e7\u00f5es usadas DbGetData() DbBeginTrans() DbRollBack() Classes usadas CalculaParcelas ConexaoOdbc C\u00f3digo fun\u00e7\u00e3o Function LiquidaContrato() Dim CurParcelas As New CursorOdbc Dim dblTotalParcelas As Currency Dim strParcelas(1 To 3, 1 To 100) As Variant LiquidaContrato = \"\" dblTotalParcelas = 0 IntParcelas = 0 strSql = \"\" strSql = strSql & \"SELECT Parcela, \" strSql = strSql & \"Principal + Receita + ReceitaAtraso AS Saldo \" strSql = strSql & \"FROM Parcelas \" strSql = strSql & \"WHERE Empresa = '\" & StrEmpresaAtiva & \"' \" strSql = strSql & \"AND Agencia = '\" & strAgencia & \"' \" strSql = strSql & \"AND Contrato = '\" & strContrato & \"' \" strSql = strSql & \"AND Situacao = 'A' \" strSql = strSql & \"ORDER BY Parcela \" Set CurParcelas = CnxPermanente.DbOpenCursor(strSql) If CurParcelas.Eof Then CurParcelas.DbCloseCursor LiquidaContrato = \"Contrato n\u00e3o possui parcelas abertas!\" Exit Function End If Do While Not CurParcelas.Eof IntParcelas = IntParcelas + 1 dblTotalParcelas = dblTotalParcelas + CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(1, IntParcelas) = CurParcelas.DbGetData(\"Parcela\") strParcelas(2, IntParcelas) = CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(3, IntParcelas) = 0 CurParcelas.DbMoveNext Loop CurParcelas.DbCloseCursor 'Divide os valores proporcionalmente '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - dblValorAcumulado = 0 For i% = 1 To IntParcelas If i% <> IntParcelas Then strParcelas(3, i%) = CCur(Format((strParcelas(2, i%) / dblTotalParcelas) * dblValorPago, \"########0.00\")) Else strParcelas(3, i%) = dblValorPago - dblValorAcumulado End If dblValorAcumulado = dblValorAcumulado + strParcelas(3, i%) Next i% 'Trata a liquida\u00e7\u00e3o do Contrato '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - CnxPermanente.DbBeginTrans For i% = 1 To IntParcelas Set clsCalculaParcelas = New CalculaParcelas clsCalculaParcelas.strContrato = strContrato clsCalculaParcelas.strAgencia = strAgencia clsCalculaParcelas.strParcela = strParcelas(1, i%) clsCalculaParcelas.varDataPagamento = varDataPagamento clsCalculaParcelas.varDataMovimento = varDataPagamento clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strUsuarioAtivo = strUsuario If strClienteSicred = \"SULFINANCEIRA\" Or strClienteSicred = \"MATONE\" Then clsCalculaParcelas.strAceitaDesconto = \"S\" Else clsCalculaParcelas.strAceitaDesconto = \"N\" End If clsCalculaParcelas.CalculaValores True strFormaPagamento = clsCalculaParcelas.strFormaPagamento If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If 'Efetua o pagamento da parcela '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - clsCalculaParcelas.strOrgaoRecebedor = strOrgaoRecebedor clsCalculaParcelas.varDataFinanceira = varDataPagamento clsCalculaParcelas.dblValorPago = strParcelas(3, i%) clsCalculaParcelas.strFormaPagamento = strFormaPagamento clsCalculaParcelas.StrBanco = \"\" clsCalculaParcelas.strCheque = \"\" clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strLiquidacaoPorDentro = IIf(strOrgaoRecebedor = \"80000\", \"S\", \"N\") clsCalculaParcelas.PagaParcela If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If Set clsCalculaParcelas = Nothing Next i% CnxPermanente.DbCommitTrans End Function","title":"LiquidaContrato()"},{"location":"liquida_contrato/#funcao-liquidacontrato","text":"","title":"Fun\u00e7\u00e3o - LiquidaContrato()"},{"location":"liquida_contrato/#proposito","text":"Realizar a liquida\u00e7\u00e3o das parcelas do contrato.","title":"Prop\u00f3sito"},{"location":"liquida_contrato/#input","text":"Nulo","title":"Input"},{"location":"liquida_contrato/#output","text":"Nulo","title":"Output"},{"location":"liquida_contrato/#descricao-tecnica","text":"Func - 1.0.0- Cria uma consulta na tabela Parcelas selecionando o campo Parcela , e soma os campos Principal , Receita , ReceitaAtraso para criar 'Saldo'. Filtra pelos campos Empresa , Agencia , Contrato e Situacao igual a 'A'. Func - 1.0.1- Realiza a execu\u00e7\u00e3o da consulta Func -1.0.0 e verifica se existem dados, caso n\u00e3o haja, salva a mensagem 'Contrato n\u00e3o possui parcelas abertas!' na vari\u00e1vel LiquidaContrato e encerra a fun\u00e7\u00e3o [ LiquidaContrato() ]. Func - 1.0.2- Caso haja dados na consulta de Func - 1.0.1, percorre os valores e atribui os valores para o vetor strParcelas , e incrementa a vari\u00e1vel IntParcelas . Divide os valores proporcionalmente Func - 1.0.3- Verifica o tamanho da vari\u00e1vel IntParcelas , enquanto n\u00e3o percorrer a o \u00faltimo valor, preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: vetor strParcelas posi\u00e7\u00e3o 2, dividido pela vari\u00e1vel dblTotalParcelas e multiplicado pela vari\u00e1vel dblValorPago . Caso seja a \u00faltima posi\u00e7\u00e3o preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: a vari\u00e1vel dblValorPago menos a vari\u00e1vel dblValorAcumulado . Func - 1.0.4- A vari\u00e1vel dblValorAcumulado recebe ela mais o valor da posi\u00e7\u00e3o 3 do vetor strParcelas . Trata a liquida\u00e7\u00e3o do Contrato Func - 1.0.5- Cria o objeto clsCalculaParcelas usando a classe CalculaParcelas e preenche atributos: [strContrato],[strAgencia],[strParcela],[varDataPagamento],[varDataMovimento],[intAbreTransacao],[strUsuarioAtivo] com valores de vari\u00e1veis. Func - 1.0.6- Verifica se a vari\u00e1vel strClienteSicred \u00e9 igual a \"SULFINANCEIRA\" ou \"MATONE\", se sim, aplica ao atributo [strAceitaDesconto] o valor de 'S' e 'N' respectivamente. Func - 1.0.7- Verifica se a vari\u00e1vel .................................","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"liquida_contrato/#funcoes-usadas","text":"DbGetData() DbBeginTrans() DbRollBack()","title":"Fun\u00e7\u00f5es usadas"},{"location":"liquida_contrato/#classes-usadas","text":"CalculaParcelas ConexaoOdbc","title":"Classes usadas"},{"location":"liquida_contrato/#codigo-funcao","text":"Function LiquidaContrato() Dim CurParcelas As New CursorOdbc Dim dblTotalParcelas As Currency Dim strParcelas(1 To 3, 1 To 100) As Variant LiquidaContrato = \"\" dblTotalParcelas = 0 IntParcelas = 0 strSql = \"\" strSql = strSql & \"SELECT Parcela, \" strSql = strSql & \"Principal + Receita + ReceitaAtraso AS Saldo \" strSql = strSql & \"FROM Parcelas \" strSql = strSql & \"WHERE Empresa = '\" & StrEmpresaAtiva & \"' \" strSql = strSql & \"AND Agencia = '\" & strAgencia & \"' \" strSql = strSql & \"AND Contrato = '\" & strContrato & \"' \" strSql = strSql & \"AND Situacao = 'A' \" strSql = strSql & \"ORDER BY Parcela \" Set CurParcelas = CnxPermanente.DbOpenCursor(strSql) If CurParcelas.Eof Then CurParcelas.DbCloseCursor LiquidaContrato = \"Contrato n\u00e3o possui parcelas abertas!\" Exit Function End If Do While Not CurParcelas.Eof IntParcelas = IntParcelas + 1 dblTotalParcelas = dblTotalParcelas + CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(1, IntParcelas) = CurParcelas.DbGetData(\"Parcela\") strParcelas(2, IntParcelas) = CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(3, IntParcelas) = 0 CurParcelas.DbMoveNext Loop CurParcelas.DbCloseCursor 'Divide os valores proporcionalmente '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - dblValorAcumulado = 0 For i% = 1 To IntParcelas If i% <> IntParcelas Then strParcelas(3, i%) = CCur(Format((strParcelas(2, i%) / dblTotalParcelas) * dblValorPago, \"########0.00\")) Else strParcelas(3, i%) = dblValorPago - dblValorAcumulado End If dblValorAcumulado = dblValorAcumulado + strParcelas(3, i%) Next i% 'Trata a liquida\u00e7\u00e3o do Contrato '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - CnxPermanente.DbBeginTrans For i% = 1 To IntParcelas Set clsCalculaParcelas = New CalculaParcelas clsCalculaParcelas.strContrato = strContrato clsCalculaParcelas.strAgencia = strAgencia clsCalculaParcelas.strParcela = strParcelas(1, i%) clsCalculaParcelas.varDataPagamento = varDataPagamento clsCalculaParcelas.varDataMovimento = varDataPagamento clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strUsuarioAtivo = strUsuario If strClienteSicred = \"SULFINANCEIRA\" Or strClienteSicred = \"MATONE\" Then clsCalculaParcelas.strAceitaDesconto = \"S\" Else clsCalculaParcelas.strAceitaDesconto = \"N\" End If clsCalculaParcelas.CalculaValores True strFormaPagamento = clsCalculaParcelas.strFormaPagamento If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If 'Efetua o pagamento da parcela '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - clsCalculaParcelas.strOrgaoRecebedor = strOrgaoRecebedor clsCalculaParcelas.varDataFinanceira = varDataPagamento clsCalculaParcelas.dblValorPago = strParcelas(3, i%) clsCalculaParcelas.strFormaPagamento = strFormaPagamento clsCalculaParcelas.StrBanco = \"\" clsCalculaParcelas.strCheque = \"\" clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strLiquidacaoPorDentro = IIf(strOrgaoRecebedor = \"80000\", \"S\", \"N\") clsCalculaParcelas.PagaParcela If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If Set clsCalculaParcelas = Nothing Next i% CnxPermanente.DbCommitTrans End Function","title":"C\u00f3digo fun\u00e7\u00e3o"},{"location":"operacoes/","text":"Operacoes Atualiza Sinopse ' Atualiza a Sinopse Cont\u00e1bil Al\u00e7adas de Desconto TABELA CAMPO NOME a a a a a a a a a a a Consulta Trilha de Auditoria Agendamento de Di\u00e1rias a a a a a a a a a a a a Relat\u00f3rios da Di\u00e1ria","title":"Operacoes"},{"location":"operacoes/#operacoes","text":"","title":"Operacoes"},{"location":"operacoes/#atualiza-sinopse","text":"' Atualiza a Sinopse Cont\u00e1bil","title":"Atualiza Sinopse"},{"location":"operacoes/#alcadas-de-desconto","text":"TABELA CAMPO NOME a a a a a a a a a a a","title":"Al\u00e7adas de Desconto"},{"location":"operacoes/#consulta-trilha-de-auditoria","text":"","title":"Consulta Trilha de Auditoria"},{"location":"operacoes/#agendamento-de-diarias","text":"a a a a a a a a a a a a","title":"Agendamento de Di\u00e1rias"},{"location":"operacoes/#relatorios-da-diaria","text":"","title":"Relat\u00f3rios da Di\u00e1ria"},{"location":"valida_online/","text":"Fun\u00e7\u00e3o - ValidaOnLine() Prop\u00f3sito Retorna o valor de um ou mais campos, a partir do parametro \"StrCampo\". Input String : strSql String : strCampo Optional : cnxConexao Output Dim curValidaonline As CursorOdbc Dim i As Integer Dim strField As String Dim m_ret As String On Error GoTo TrataErroValidaOnLine ValidaOnLine = \"\" If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If '------------------------------ ' Se existir inconsist\u00eancia no ' comando SQL informado ' deve ser ignorado. '------------------------------ ' HDS46267 - PEDROF - 14/12/2015 - INICIO 'If InStr(strSql, \"= ''\") <> 0 Then ' Exit Function 'End If ' HDS46267 - PEDROF - 14/12/2015 - FIM If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If Set curValidaonline = cnxConexao.DbOpenCursor(strSql) If curValidaonline.Eof Then curValidaonline.DbCloseCursor Exit Function End If If InStr(strCampo, \",\") > 0 Then For i = 0 To UBound(Split(strCampo, \",\")) strField = Split(strCampo, \",\")(i) If strField <> \"\" Then m_ret = m_ret & Trim(curValidaonline.DbGetData(strField)) & \"|\" End If Next Else m_ret = curValidaonline.DbGetData(strCampo) End If curValidaonline.DbCloseCursor ValidaOnLine = m_ret Exit Function TrataErroValidaOnLine: Set curValidaonline = Nothing Exit Function End Function","title":"Fun\u00e7\u00e3o - ValidaOnLine()"},{"location":"valida_online/#funcao-validaonline","text":"","title":"Fun\u00e7\u00e3o - ValidaOnLine()"},{"location":"valida_online/#proposito","text":"Retorna o valor de um ou mais campos, a partir do parametro \"StrCampo\".","title":"Prop\u00f3sito"},{"location":"valida_online/#input","text":"String : strSql String : strCampo Optional : cnxConexao","title":"Input"},{"location":"valida_online/#output","text":"Dim curValidaonline As CursorOdbc Dim i As Integer Dim strField As String Dim m_ret As String On Error GoTo TrataErroValidaOnLine ValidaOnLine = \"\" If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If '------------------------------ ' Se existir inconsist\u00eancia no ' comando SQL informado ' deve ser ignorado. '------------------------------ ' HDS46267 - PEDROF - 14/12/2015 - INICIO 'If InStr(strSql, \"= ''\") <> 0 Then ' Exit Function 'End If ' HDS46267 - PEDROF - 14/12/2015 - FIM If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If Set curValidaonline = cnxConexao.DbOpenCursor(strSql) If curValidaonline.Eof Then curValidaonline.DbCloseCursor Exit Function End If If InStr(strCampo, \",\") > 0 Then For i = 0 To UBound(Split(strCampo, \",\")) strField = Split(strCampo, \",\")(i) If strField <> \"\" Then m_ret = m_ret & Trim(curValidaonline.DbGetData(strField)) & \"|\" End If Next Else m_ret = curValidaonline.DbGetData(strCampo) End If curValidaonline.DbCloseCursor ValidaOnLine = m_ret Exit Function TrataErroValidaOnLine: Set curValidaonline = Nothing Exit Function End Function","title":"Output"}]}