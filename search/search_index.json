{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"baixas_em_banco_correspondente/","text":"Operacoes Atualiza Sinopse ' Atualiza a Sinopse Cont\u00e1bil Al\u00e7adas de Desconto TABELA CAMPO NOME a a a a a a a a a a a Consulta Trilha de Auditoria Agendamento de Di\u00e1rias a a a a a a a a a a a a Relat\u00f3rios da Di\u00e1ria","title":"Baixas em banco correspondente"},{"location":"baixas_em_banco_correspondente/#operacoes","text":"","title":"Operacoes"},{"location":"baixas_em_banco_correspondente/#atualiza-sinopse","text":"' Atualiza a Sinopse Cont\u00e1bil","title":"Atualiza Sinopse"},{"location":"baixas_em_banco_correspondente/#alcadas-de-desconto","text":"TABELA CAMPO NOME a a a a a a a a a a a","title":"Al\u00e7adas de Desconto"},{"location":"baixas_em_banco_correspondente/#consulta-trilha-de-auditoria","text":"","title":"Consulta Trilha de Auditoria"},{"location":"baixas_em_banco_correspondente/#agendamento-de-diarias","text":"a a a a a a a a a a a a","title":"Agendamento de Di\u00e1rias"},{"location":"baixas_em_banco_correspondente/#relatorios-da-diaria","text":"","title":"Relat\u00f3rios da Di\u00e1ria"},{"location":"configuracao_texto_padrao/","text":"Padr\u00e3o de configura\u00e7\u00f5es de texto Tipo Padr\u00e3o Vari\u00e1vel intAceitos Atributo [teste] Sub-rotina CalculaBaixas Tabela de banco de dados MovimentoDiarioEspecial Campo de banco de dados DataPagamento Funcao [ LiquidaContrato() ] Objeto clsCalculaParcelas Markdown | Vari\u00e1vel | *`intAceitos`* | | Atributo | [teste] | | Sub-rotina | **CalculaBaixas** | | Tabela de banco de dados | **`MovimentoDiarioEspecial`** | | Campo de banco de dados | `DataPagamento` | | Funcao | [*LiquidaContrato()*] | | Objeto | **clsCalculaParcelas** |","title":"Configura\u00e7\u00e3o de textos"},{"location":"configuracao_texto_padrao/#padrao-de-configuracoes-de-texto","text":"Tipo Padr\u00e3o Vari\u00e1vel intAceitos Atributo [teste] Sub-rotina CalculaBaixas Tabela de banco de dados MovimentoDiarioEspecial Campo de banco de dados DataPagamento Funcao [ LiquidaContrato() ] Objeto clsCalculaParcelas","title":"Padr\u00e3o de configura\u00e7\u00f5es de texto"},{"location":"configuracao_texto_padrao/#markdown","text":"| Vari\u00e1vel | *`intAceitos`* | | Atributo | [teste] | | Sub-rotina | **CalculaBaixas** | | Tabela de banco de dados | **`MovimentoDiarioEspecial`** | | Campo de banco de dados | `DataPagamento` | | Funcao | [*LiquidaContrato()*] | | Objeto | **clsCalculaParcelas** |","title":"Markdown"},{"location":"executa_baixas_de_parcelas/","text":"Baixas em Banco Correspondente Image Input Inteiro : Origem Inteiro : Lote Data : Data Output Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es. Descri\u00e7\u00e3o t\u00e9cnica 1 - Origem- Checkbox: 1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas 2 - Descri\u00e7\u00e3o da origem - Textbox: 2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas 3 - Lote - Checkbox: 3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas 4 - Lote - Textbox: 4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas 5 - Data- Textbox: Recebe input de data. 6 - Mensagem - Label : Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es 7 - Executar - Bot\u00e3o: 7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ). 8 - Sair - Bot\u00e3o: Fechar o formul\u00e1rio. Func\u00f5es LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ] Subrotinas e itens de navega\u00e7\u00e3o ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus Classes usadas CalculaContrato ConexaoOdbc Forms usados frmOpeBaixasAutom\u00e1ticas M\u00f3dulos usados FUNCOES Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela . Banco de dados - Tabelas atreladas Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas Fluxo de c\u00f3digo Descri\u00e7\u00e3o negocial Realiza a baixa de parcelas usando origem, lote e data. Descri\u00e7\u00e3o negocial- Flow","title":"Executa Baixas de Parcelas"},{"location":"executa_baixas_de_parcelas/#baixas-em-banco-correspondente","text":"","title":"Baixas em Banco Correspondente"},{"location":"executa_baixas_de_parcelas/#image","text":"","title":"Image"},{"location":"executa_baixas_de_parcelas/#input","text":"Inteiro : Origem Inteiro : Lote Data : Data","title":"Input"},{"location":"executa_baixas_de_parcelas/#output","text":"Decimal : Valor em R$ do total das baixas. Inteiro : Quantidade total de baixas. Inteiro : Quantidade total de rejei\u00e7\u00f5es.","title":"Output"},{"location":"executa_baixas_de_parcelas/#descricao-tecnica","text":"","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas/#1-origem-checkbox","text":"1.0.1 - Verifica se o checkbox est\u00e1 clicado, se sim, atribui para o item 2 o valor de vazio e ativa como vis\u00edvel. 1.0.2 - Se o checkbox n\u00e3o est\u00e1 clicado, atribui para o item 2 o valor de vazio e ativa como invis\u00edvel. 1.0.3 - Chama a Sub rotina CalculaBaixas","title":"1 - Origem- Checkbox:"},{"location":"executa_baixas_de_parcelas/#2-descricao-da-origem-textbox","text":"2.0.1 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 2.0.2 - Chama a Sub rotina CalculaBaixas","title":"2 - Descri\u00e7\u00e3o da origem - Textbox:"},{"location":"executa_baixas_de_parcelas/#3-lote-checkbox","text":"3.0.1 - Checa se o checkbox est\u00e1 clicado, se sim atribui vazio para o item 4 e ativa para receber input. 3.0.2 - Checa se o checkbox est\u00e1 clicado, se n\u00e3o atribui vazio para o item 4 e o desativa para receber input. 3.0.3 - Chama a Sub rotina CalculaBaixas","title":"3 - Lote - Checkbox:"},{"location":"executa_baixas_de_parcelas/#4-lote-textbox","text":"4.0.1 - Cria consulta SQL na tabela MovimentoDiarioEspecial selecionando o campo Origem filtrando pelo n\u00famero do campo Lote da tabela. 4.0.2 - Executa consulta no banco de dados. 4.0.3 - Checa se o n\u00famero do lote existe, se sim, coloca ele no campo Textbox. Se n\u00e3o, exibe a seguinte mensagem \"N\u00famero de lote n\u00e3o existente para baixa autom\u00e1tica de parcelas\". 4.0.4 - Checa se o textbox tem valor '14', se n\u00e3o, desabilita o campo do item 5 colocando a data de hoje. Se sim, coloca 14 no textbox e deixa habilitado o item 5. 4.0.5 - Chama a Sub rotina CalculaBaixas","title":"4 - Lote - Textbox:"},{"location":"executa_baixas_de_parcelas/#5-data-textbox","text":"Recebe input de data.","title":"5 - Data- Textbox:"},{"location":"executa_baixas_de_parcelas/#6-mensagem-label","text":"Exibe valor em R$ do total de baixas Exibe quantidade total de baixas Exibe quantidade total de rejei\u00e7\u00f5es","title":"6 - Mensagem - Label :"},{"location":"executa_baixas_de_parcelas/#7-executar-botao","text":"7.0.1 - Checa se os campos est\u00e3o vazios. 7.0.2 - Checa se a data (Item5) est\u00e1 preenchida e no formato correto. 7.0.3 - Verifica se o checkbox Origem (Item 1) e Lote (Item 3) est\u00e3o preenchidos 7.0.4 - Checa se a vari\u00e1vel strTipoBD tem valor \u201cORACLE\u201d, sem sim faz uma consulta no banco de dados na tabela MovimentoDiarioEspecial colocando empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido e seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.5 - Se a vari\u00e1vel strTipoBD \u00e9 diferente de \u201cORACLE\u201d: Faz uma consulta selecionando os campos: Contrato , Agencia , Parcela , DataPagamento , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , OrgaoRecebedor , TipoValor , Origem , Lote e adiciona os campos TarifaAntecipacao com valor 0 e Sinistro como vazio. Adiciona tamb\u00e9m na consulta empresa ativa e data do movimento. Inclui Origem e Lote caso checkbox estiver preenchido , seta \u2018Situacao\u2019 para \u201800\u2019 e ORIGEM para \u201802\u2019. 7.0.6 - Verifica se a consulta traz valores de acordo com os filtros acima. 7.0.7 - Cria o arquivo \"baixasautomaticas.txt\". Verifica se o campo ValorDoc da tabela MovimentoDiarioEspecial \u00e9 menor que 0, se sim, atribui a vari\u00e1vel dblValorDoc o valor de 0. 7.0.8 - Salva o resultado da consulta no arquivo 'baixasautomaticas.txt' 7.0.9 - Abre o arquivo 'baixasautomaticas.txt' e l\u00ea linha a linha atribuindo os valores do txt para as seguintes vari\u00e1veis: strContrato , strAgencia ,, strParcela ,, varDataPagamento ,, dblValorPago ,, dblValorDoc ,, dblValorVencimento ,, dblJurosMulta ,, dblIofAtraso ,, dblDespesas ,, dblDescontoComandado ,, strOrgaoRecebedor ,, strTipoValor ,, strOrigem , StrLote , dblTarifaAntecipacao , strSinistro Trata pagamento total ou parcial 7.1.0 - Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02,03 ou 07. 7.1.1 - Cria um objeto atribuindo os valores de 7.0.9. 7.1.2 - Verifica se o atributo [ strResultado ] do objeto clsCalculaParcelas \u00e9 vazio, se sim, incrementa a vari\u00e1vel intRejeitados e monta uma consulta de update SQL do primeiro item da tabela MovimentoDiarioEspecial , setando o campo Situacao para 02 e os restantes com as vari\u00e1veis de 7.0.9. 7.1.3 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07 e se sim, adiciona a consulta SQL de 7.1.2 o campo Lote com valor de StrLote de 7.0.9. 7.1.4 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.1.5 - Executa a consulta no banco de dados. Efetua o pagamento da parcela 7.1.6 - Usa o objeto clsCalculaParcelas e seu atributos: [ StrBanco ], [ strCheque ], [ dblValorVencimento ], [ dblJurosMulta ], [ dblIofAtraso ], [ dblDespesas ], [ dblDescontoComandado ], [ dblTarifaAntecipacao ],[ strSinistro ] com os valores de 7.0.9. E com o atributo [ strLiquidacaoPorDentro ] checa se a vari\u00e1vel strOrgaoRecebedor \u00e9 igual a '80000', se sim atribui 'S' e se n\u00e3o 'N'. 7.1.7 - Cria uma consulta SQL que seleciona os campos Contrato , PMT da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , Agencia , Parcela , Contrato . 7.1.8 - Executa consulta de 7.1.8 7.1.9 - Verifica resultados da consulta, se retornou dados atribui o valor de FALSE para a vari\u00e1vel strContratoConsignado e para o atributo [ strContratoConsignado ] do objeto clsCalculaParcelas . Se n\u00e3o atribui TRUE. 7.2.0 - Verifica se [ strContratoConsignado ] \u00e9 TRUE, se sim, cria um consulta SQL de sele\u00e7\u00e3o na tabela Parcelas do campo PMT , e faz a soma dos campos ( Principal , Receita , SaldoRenda , , RendaRevertida ) gerando o nome de 'SaldoParcela'. 7.2.1 - Cria o atributo [ dblValorVencimento ] do objeto clsCalculaParcelas o valor da vari\u00e1vel dblValorPago de 7.0.9. 7.2.2- Cria a vari\u00e1vel dblVlr com o valor da consulta item 7.2.0 do campo , SaldoParcela . 7.2.3- Checa se vari\u00e1vel dblValorPago \u00e9 maior que dblVlr , se sim atribui a vari\u00e1vel strResultado a mensagem \"Valor recebido \u00e9 maior que o saldo em aberto da parcela\". 7.2.4- Verifica se a vari\u00e1vel strResultado \u00e9 igual a vazio, se sim, verifica se a vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a '03', atribui TRUE e FALSE respectivamente para o atributo [ PagaParcela ] de objeto clsCalculaParcelas . 7.2.5- Checa se atributo [ strResultado ] e vari\u00e1vel strResultado s\u00e3o direferantes de vazio. Se sim, incrementa vari\u00e1vel intRejeitados e monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.2.6 - Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.2.7 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.2.8 - Executa a consulta no banco de dados. 7.2.9 - Incrementa vari\u00e1vel intAceitos . 7.3.0 - Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes com a checagem do atributo [ strResultado ] for igual a vazio preenche com do atributo [ strResultado ] se n\u00e3o com a vari\u00e1vel strResultado . Cria condi\u00e7\u00e3o com os campos da tabela com as var\u00edavels de 7.0.9. 7.3.1- Mesmo procedimento de 7.2.6. 7.3.2- Checa se o valor da vari\u00e1vel strTipoValor\u00b4 \u00e9 igual a 02 ou 05. 7.3.3- Incremanta vari\u00e1vel intProcessados . 7.3.4- Chama a fun\u00e7\u00e3o LiquidaContrato() e atribui o resultado dela para a v\u00e1riavel strResultado . 7.3.5- Checa se vari\u00e1vel strResultado \u00e9 diferente de vazio, se sim, incrementa vari\u00e1vel intRejeitados . 7.3.6- Mesmo procedimento de 7.3.0. 7.3.7- Incrementa vari\u00e1vel intAceitos . 7.3.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '01', seta campo Observacoes para vazio. Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.3.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.4.0 - Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . 7.4.1 - Executa a consulta no banco de dados. 7.4.2- Atribui a mensagem 'Tipo de Boleto n\u00e3o suportado!' para a vari\u00e1vel strObservacao . 7.4.3- Checa se o valor da vari\u00e1vel strTipoValor \u00e9 igual a 99. Se sim, monta consulta SQL com os seguinte campo Observacoes da tabela MovimentoDiarioEspecial e filtra pelos campos Empresa , DataMovimento , Agencia , Contrato , Parcela , ValorPago , ValorDoc , Saldo , JurosMulta , IOC , Despesa , Desconto , TarifaAntecipacao . 7.4.4- Mesmo procedimento de 7.3.9. 7.4.5- Mesmo procedimento de 7.4.0. 7.4.6- Chama a fun\u00e7\u00e3o ValidaOnLine() passando como par\u00e2metro a string de SQL de 7.4.3 e o campo de Observacoes com alias de 'Obs'. Salva o resultado na vari\u00e1vel strObservacaoLida . Checa se strObservacaoLida \u00e9 diferente de vazio, se sim, atribui para a vari\u00e1vel strObservacao o valor de strObservacaoLida . 7.4.7- Incrementa vari\u00e1vel intRejeitados . 7.4.8- Monta consulta SQL de update na tabela MovimentoDiarioEspecial . Seta campo Situacao para '02', seta campo Observacoes para o valor da vari\u00e1vel strObservacao . Cria condi\u00e7\u00e3o de atualiza\u00e7\u00e3o de acordo com os campos da tabela e com as var\u00edavels de 7.0.9. 7.4.9- Verifica se a vari\u00e1vel txtOrigem \u00e9 igual a 07, se sim, adiciona a consulta SQL de 7.2.5 o campo Lote com valor de StrLote de 7.0.9. 7.5.0- Atribui a consulta SQL de 7.0.9 o valor de '00' para o campo Situacao . - 7.5.1- Executa a consulta no banco de dados. - 7.5.2- Mostra na tela valores no item 6. - 7.5.3- Exibe mensagem de aviso sobre o processo conclu\u00eddo, mostra quantidade de erros, quantidade de baixas aceitas (vari\u00e1vel intAceitos ), quantidade de baixas rejeitadas (vari\u00e1vel intRejeitados ).","title":"7 - Executar - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas/#8-sair-botao","text":"Fechar o formul\u00e1rio.","title":"8 - Sair - Bot\u00e3o:"},{"location":"executa_baixas_de_parcelas/#funcoes","text":"LiquidaContrato() ValidaOnLine() FormataData() [ DbOpenCursor ] DbGetData [ DbCloseCursor ]","title":"Func\u00f5es"},{"location":"executa_baixas_de_parcelas/#subrotinas-e-itens-de-navegacao","text":"ChkLote_Click ChkOrigem_Click CalculaBaixas Cancela CmdlistaOrigem_Click Form_Load txtLote_LostFocus TxtOrigem_lostfocus","title":"Subrotinas  e itens de navega\u00e7\u00e3o"},{"location":"executa_baixas_de_parcelas/#classes-usadas","text":"CalculaContrato ConexaoOdbc","title":"Classes usadas"},{"location":"executa_baixas_de_parcelas/#forms-usados","text":"frmOpeBaixasAutom\u00e1ticas","title":"Forms usados"},{"location":"executa_baixas_de_parcelas/#modulos-usados","text":"FUNCOES","title":"M\u00f3dulos usados"},{"location":"executa_baixas_de_parcelas/#subrotinas-descricao-tecnica","text":"Sub - Cancela Sub - 1.0.0 - Apaga todos os valores do form. Sub - 1.0.1 - Chama item 1 Origem- Checkbox e item 3 - Lote - Checkbox. Sub - CalculaBaixas Sub - 2.0.0 - Cria consulta SQL de sele\u00e7\u00e3o na tabela MovimentoDiarioEspecial somando os campos ValorPago e Despesa , e fazendo uma contagem da quantidade de linhas. Filtra pelo campos Empresa . DataMovimento e Situacao diferente de '01'. Sub - 2.0.1- Verifica se os valores de checkbox de Lote (item 1) e de Origem (item 3) est\u00e3o preenchidos, se sim, adiciona a consulta o filtro. Sub - 2.0.2- Realiza a consulta de Sub 2.0.0 e salva os valores na vari\u00e1vel lngTotalRegArquivo . Sub - 2.0.3- Realiza mesmo procedimento de Sub - 2.0.0 e Sub - 2.0.1, alterando apenas o filtro de Situacao igual a '00'. Sub - 2.0.4- Realiza consulta no banco de dados, e caso retornem dados atualiza form para valores vazios e sai da sub CalculaBaixas . Sub - 2.0.5- Atrav\u00e9s da fun\u00e7\u00e3o DbGetData preenche o item 6 com a o Valor total das baixas, Quantidade total de baixas, Quantidade de rejei\u00e7\u00f5es. Sub - 2.0.6- Verifica se o item 2 est\u00e1 preenchido com o valor '09', se sim, atribui o 'Valor total de baixas' para a vari\u00e1vel TxtBaixas . Sub - Form_Load Sub - 3.0.0 - Chama a Centraform e a sub rotina Cancela .","title":"Subrotinas - Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"executa_baixas_de_parcelas/#banco-de-dados-tabelas-atreladas","text":"Nome da tabela MovimentoDiarioAcordos ConvenioFaturaDetalhe Parcelas Origem Bancos MovimentoDiarioEspecial CobrancaParcelasAcordosParcelas","title":"Banco de dados - Tabelas atreladas"},{"location":"executa_baixas_de_parcelas/#fluxo-de-codigo","text":"","title":"Fluxo de c\u00f3digo"},{"location":"executa_baixas_de_parcelas/#descricao-negocial","text":"Realiza a baixa de parcelas usando origem, lote e data.","title":"Descri\u00e7\u00e3o negocial"},{"location":"executa_baixas_de_parcelas/#descricao-negocial-flow","text":"","title":"Descri\u00e7\u00e3o negocial- Flow"},{"location":"liquida_contrato/","text":"Fun\u00e7\u00e3o - LiquidaContrato() Prop\u00f3sito Realizar a liquida\u00e7\u00e3o das parcelas do contrato. Input Nulo Output Nulo Descri\u00e7\u00e3o t\u00e9cnica Func - 1.0.0- Cria uma consulta na tabela Parcelas selecionando o campo Parcela , e soma os campos Principal , Receita , ReceitaAtraso para criar 'Saldo'. Filtra pelos campos Empresa , Agencia , Contrato e Situacao igual a 'A'. Func - 1.0.1- Realiza a execu\u00e7\u00e3o da consulta Func -1.0.0 e verifica se existem dados, caso n\u00e3o haja, salva a mensagem 'Contrato n\u00e3o possui parcelas abertas!' na vari\u00e1vel LiquidaContrato e encerra a fun\u00e7\u00e3o [ LiquidaContrato() ]. Func - 1.0.2- Caso haja dados na consulta de Func - 1.0.1, percorre os valores e atribui os valores para o vetor strParcelas , e incrementa a vari\u00e1vel IntParcelas . Divide os valores proporcionalmente Func - 1.0.3- Verifica o tamanho da vari\u00e1vel IntParcelas , enquanto n\u00e3o percorrer a o \u00faltimo valor, preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: vetor strParcelas posi\u00e7\u00e3o 2, dividido pela vari\u00e1vel dblTotalParcelas e multiplicado pela vari\u00e1vel dblValorPago . Caso seja a \u00faltima posi\u00e7\u00e3o preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: a vari\u00e1vel dblValorPago menos a vari\u00e1vel dblValorAcumulado . Func - 1.0.4- A vari\u00e1vel dblValorAcumulado recebe ela mais o valor da posi\u00e7\u00e3o 3 do vetor strParcelas . Trata a liquida\u00e7\u00e3o do Contrato Func - 1.0.5- Cria o objeto clsCalculaParcelas usando a classe CalculaParcelas e preenche atributos: [strContrato],[strAgencia],[strParcela],[varDataPagamento],[varDataMovimento],[intAbreTransacao],[strUsuarioAtivo] com valores de vari\u00e1veis. Func - 1.0.6- Verifica se a vari\u00e1vel strClienteSicred \u00e9 igual a \"SULFINANCEIRA\" ou \"MATONE\", se sim, aplica ao atributo [strAceitaDesconto] o valor de 'S' e 'N' respectivamente. Func - 1.0.7- Verifica se a vari\u00e1vel ................................. Fun\u00e7\u00f5es usadas DbGetData() DbBeginTrans() DbRollBack() Classes usadas CalculaParcelas ConexaoOdbc C\u00f3digo fun\u00e7\u00e3o Function LiquidaContrato() Dim CurParcelas As New CursorOdbc Dim dblTotalParcelas As Currency Dim strParcelas(1 To 3, 1 To 100) As Variant LiquidaContrato = \"\" dblTotalParcelas = 0 IntParcelas = 0 strSql = \"\" strSql = strSql & \"SELECT Parcela, \" strSql = strSql & \"Principal + Receita + ReceitaAtraso AS Saldo \" strSql = strSql & \"FROM Parcelas \" strSql = strSql & \"WHERE Empresa = '\" & StrEmpresaAtiva & \"' \" strSql = strSql & \"AND Agencia = '\" & strAgencia & \"' \" strSql = strSql & \"AND Contrato = '\" & strContrato & \"' \" strSql = strSql & \"AND Situacao = 'A' \" strSql = strSql & \"ORDER BY Parcela \" Set CurParcelas = CnxPermanente.DbOpenCursor(strSql) If CurParcelas.Eof Then CurParcelas.DbCloseCursor LiquidaContrato = \"Contrato n\u00e3o possui parcelas abertas!\" Exit Function End If Do While Not CurParcelas.Eof IntParcelas = IntParcelas + 1 dblTotalParcelas = dblTotalParcelas + CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(1, IntParcelas) = CurParcelas.DbGetData(\"Parcela\") strParcelas(2, IntParcelas) = CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(3, IntParcelas) = 0 CurParcelas.DbMoveNext Loop CurParcelas.DbCloseCursor 'Divide os valores proporcionalmente '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - dblValorAcumulado = 0 For i% = 1 To IntParcelas If i% <> IntParcelas Then strParcelas(3, i%) = CCur(Format((strParcelas(2, i%) / dblTotalParcelas) * dblValorPago, \"########0.00\")) Else strParcelas(3, i%) = dblValorPago - dblValorAcumulado End If dblValorAcumulado = dblValorAcumulado + strParcelas(3, i%) Next i% 'Trata a liquida\u00e7\u00e3o do Contrato '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - CnxPermanente.DbBeginTrans For i% = 1 To IntParcelas Set clsCalculaParcelas = New CalculaParcelas clsCalculaParcelas.strContrato = strContrato clsCalculaParcelas.strAgencia = strAgencia clsCalculaParcelas.strParcela = strParcelas(1, i%) clsCalculaParcelas.varDataPagamento = varDataPagamento clsCalculaParcelas.varDataMovimento = varDataPagamento clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strUsuarioAtivo = strUsuario If strClienteSicred = \"SULFINANCEIRA\" Or strClienteSicred = \"MATONE\" Then clsCalculaParcelas.strAceitaDesconto = \"S\" Else clsCalculaParcelas.strAceitaDesconto = \"N\" End If clsCalculaParcelas.CalculaValores True strFormaPagamento = clsCalculaParcelas.strFormaPagamento If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If 'Efetua o pagamento da parcela '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - clsCalculaParcelas.strOrgaoRecebedor = strOrgaoRecebedor clsCalculaParcelas.varDataFinanceira = varDataPagamento clsCalculaParcelas.dblValorPago = strParcelas(3, i%) clsCalculaParcelas.strFormaPagamento = strFormaPagamento clsCalculaParcelas.StrBanco = \"\" clsCalculaParcelas.strCheque = \"\" clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strLiquidacaoPorDentro = IIf(strOrgaoRecebedor = \"80000\", \"S\", \"N\") clsCalculaParcelas.PagaParcela If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If Set clsCalculaParcelas = Nothing Next i% CnxPermanente.DbCommitTrans End Function","title":"LiquidaContrato()"},{"location":"liquida_contrato/#funcao-liquidacontrato","text":"","title":"Fun\u00e7\u00e3o - LiquidaContrato()"},{"location":"liquida_contrato/#proposito","text":"Realizar a liquida\u00e7\u00e3o das parcelas do contrato.","title":"Prop\u00f3sito"},{"location":"liquida_contrato/#input","text":"Nulo","title":"Input"},{"location":"liquida_contrato/#output","text":"Nulo","title":"Output"},{"location":"liquida_contrato/#descricao-tecnica","text":"Func - 1.0.0- Cria uma consulta na tabela Parcelas selecionando o campo Parcela , e soma os campos Principal , Receita , ReceitaAtraso para criar 'Saldo'. Filtra pelos campos Empresa , Agencia , Contrato e Situacao igual a 'A'. Func - 1.0.1- Realiza a execu\u00e7\u00e3o da consulta Func -1.0.0 e verifica se existem dados, caso n\u00e3o haja, salva a mensagem 'Contrato n\u00e3o possui parcelas abertas!' na vari\u00e1vel LiquidaContrato e encerra a fun\u00e7\u00e3o [ LiquidaContrato() ]. Func - 1.0.2- Caso haja dados na consulta de Func - 1.0.1, percorre os valores e atribui os valores para o vetor strParcelas , e incrementa a vari\u00e1vel IntParcelas . Divide os valores proporcionalmente Func - 1.0.3- Verifica o tamanho da vari\u00e1vel IntParcelas , enquanto n\u00e3o percorrer a o \u00faltimo valor, preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: vetor strParcelas posi\u00e7\u00e3o 2, dividido pela vari\u00e1vel dblTotalParcelas e multiplicado pela vari\u00e1vel dblValorPago . Caso seja a \u00faltima posi\u00e7\u00e3o preenche a posi\u00e7\u00e3o 3 do vetor strParcelas com: a vari\u00e1vel dblValorPago menos a vari\u00e1vel dblValorAcumulado . Func - 1.0.4- A vari\u00e1vel dblValorAcumulado recebe ela mais o valor da posi\u00e7\u00e3o 3 do vetor strParcelas . Trata a liquida\u00e7\u00e3o do Contrato Func - 1.0.5- Cria o objeto clsCalculaParcelas usando a classe CalculaParcelas e preenche atributos: [strContrato],[strAgencia],[strParcela],[varDataPagamento],[varDataMovimento],[intAbreTransacao],[strUsuarioAtivo] com valores de vari\u00e1veis. Func - 1.0.6- Verifica se a vari\u00e1vel strClienteSicred \u00e9 igual a \"SULFINANCEIRA\" ou \"MATONE\", se sim, aplica ao atributo [strAceitaDesconto] o valor de 'S' e 'N' respectivamente. Func - 1.0.7- Verifica se a vari\u00e1vel .................................","title":"Descri\u00e7\u00e3o t\u00e9cnica"},{"location":"liquida_contrato/#funcoes-usadas","text":"DbGetData() DbBeginTrans() DbRollBack()","title":"Fun\u00e7\u00f5es usadas"},{"location":"liquida_contrato/#classes-usadas","text":"CalculaParcelas ConexaoOdbc","title":"Classes usadas"},{"location":"liquida_contrato/#codigo-funcao","text":"Function LiquidaContrato() Dim CurParcelas As New CursorOdbc Dim dblTotalParcelas As Currency Dim strParcelas(1 To 3, 1 To 100) As Variant LiquidaContrato = \"\" dblTotalParcelas = 0 IntParcelas = 0 strSql = \"\" strSql = strSql & \"SELECT Parcela, \" strSql = strSql & \"Principal + Receita + ReceitaAtraso AS Saldo \" strSql = strSql & \"FROM Parcelas \" strSql = strSql & \"WHERE Empresa = '\" & StrEmpresaAtiva & \"' \" strSql = strSql & \"AND Agencia = '\" & strAgencia & \"' \" strSql = strSql & \"AND Contrato = '\" & strContrato & \"' \" strSql = strSql & \"AND Situacao = 'A' \" strSql = strSql & \"ORDER BY Parcela \" Set CurParcelas = CnxPermanente.DbOpenCursor(strSql) If CurParcelas.Eof Then CurParcelas.DbCloseCursor LiquidaContrato = \"Contrato n\u00e3o possui parcelas abertas!\" Exit Function End If Do While Not CurParcelas.Eof IntParcelas = IntParcelas + 1 dblTotalParcelas = dblTotalParcelas + CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(1, IntParcelas) = CurParcelas.DbGetData(\"Parcela\") strParcelas(2, IntParcelas) = CCur(CurParcelas.DbGetData(\"Saldo\")) strParcelas(3, IntParcelas) = 0 CurParcelas.DbMoveNext Loop CurParcelas.DbCloseCursor 'Divide os valores proporcionalmente '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - dblValorAcumulado = 0 For i% = 1 To IntParcelas If i% <> IntParcelas Then strParcelas(3, i%) = CCur(Format((strParcelas(2, i%) / dblTotalParcelas) * dblValorPago, \"########0.00\")) Else strParcelas(3, i%) = dblValorPago - dblValorAcumulado End If dblValorAcumulado = dblValorAcumulado + strParcelas(3, i%) Next i% 'Trata a liquida\u00e7\u00e3o do Contrato '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - CnxPermanente.DbBeginTrans For i% = 1 To IntParcelas Set clsCalculaParcelas = New CalculaParcelas clsCalculaParcelas.strContrato = strContrato clsCalculaParcelas.strAgencia = strAgencia clsCalculaParcelas.strParcela = strParcelas(1, i%) clsCalculaParcelas.varDataPagamento = varDataPagamento clsCalculaParcelas.varDataMovimento = varDataPagamento clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strUsuarioAtivo = strUsuario If strClienteSicred = \"SULFINANCEIRA\" Or strClienteSicred = \"MATONE\" Then clsCalculaParcelas.strAceitaDesconto = \"S\" Else clsCalculaParcelas.strAceitaDesconto = \"N\" End If clsCalculaParcelas.CalculaValores True strFormaPagamento = clsCalculaParcelas.strFormaPagamento If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If 'Efetua o pagamento da parcela '- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - clsCalculaParcelas.strOrgaoRecebedor = strOrgaoRecebedor clsCalculaParcelas.varDataFinanceira = varDataPagamento clsCalculaParcelas.dblValorPago = strParcelas(3, i%) clsCalculaParcelas.strFormaPagamento = strFormaPagamento clsCalculaParcelas.StrBanco = \"\" clsCalculaParcelas.strCheque = \"\" clsCalculaParcelas.intAbreTransacao = False clsCalculaParcelas.strLiquidacaoPorDentro = IIf(strOrgaoRecebedor = \"80000\", \"S\", \"N\") clsCalculaParcelas.PagaParcela If clsCalculaParcelas.strResultado <> \"\" Then LiquidaContrato = clsCalculaParcelas.strResultado Set clsCalculaParcelas = Nothing CnxPermanente.DbRollBack Exit Function End If Set clsCalculaParcelas = Nothing Next i% CnxPermanente.DbCommitTrans End Function","title":"C\u00f3digo fun\u00e7\u00e3o"},{"location":"operacoes/","text":"Operacoes Atualiza Sinopse ' Atualiza a Sinopse Cont\u00e1bil Al\u00e7adas de Desconto TABELA CAMPO NOME a a a a a a a a a a a Consulta Trilha de Auditoria Agendamento de Di\u00e1rias a a a a a a a a a a a a Relat\u00f3rios da Di\u00e1ria","title":"Operacoes"},{"location":"operacoes/#operacoes","text":"","title":"Operacoes"},{"location":"operacoes/#atualiza-sinopse","text":"' Atualiza a Sinopse Cont\u00e1bil","title":"Atualiza Sinopse"},{"location":"operacoes/#alcadas-de-desconto","text":"TABELA CAMPO NOME a a a a a a a a a a a","title":"Al\u00e7adas de Desconto"},{"location":"operacoes/#consulta-trilha-de-auditoria","text":"","title":"Consulta Trilha de Auditoria"},{"location":"operacoes/#agendamento-de-diarias","text":"a a a a a a a a a a a a","title":"Agendamento de Di\u00e1rias"},{"location":"operacoes/#relatorios-da-diaria","text":"","title":"Relat\u00f3rios da Di\u00e1ria"},{"location":"valida_online/","text":"Fun\u00e7\u00e3o - ValidaOnLine() Prop\u00f3sito Retorna o valor de um ou mais campos, a partir do parametro \"StrCampo\". Input String : strSql String : strCampo Optional : cnxConexao Output Dim curValidaonline As CursorOdbc Dim i As Integer Dim strField As String Dim m_ret As String On Error GoTo TrataErroValidaOnLine ValidaOnLine = \"\" If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If '------------------------------ ' Se existir inconsist\u00eancia no ' comando SQL informado ' deve ser ignorado. '------------------------------ ' HDS46267 - PEDROF - 14/12/2015 - INICIO 'If InStr(strSql, \"= ''\") <> 0 Then ' Exit Function 'End If ' HDS46267 - PEDROF - 14/12/2015 - FIM If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If Set curValidaonline = cnxConexao.DbOpenCursor(strSql) If curValidaonline.Eof Then curValidaonline.DbCloseCursor Exit Function End If If InStr(strCampo, \",\") > 0 Then For i = 0 To UBound(Split(strCampo, \",\")) strField = Split(strCampo, \",\")(i) If strField <> \"\" Then m_ret = m_ret & Trim(curValidaonline.DbGetData(strField)) & \"|\" End If Next Else m_ret = curValidaonline.DbGetData(strCampo) End If curValidaonline.DbCloseCursor ValidaOnLine = m_ret Exit Function TrataErroValidaOnLine: Set curValidaonline = Nothing Exit Function End Function","title":"ValidaOnLine()"},{"location":"valida_online/#funcao-validaonline","text":"","title":"Fun\u00e7\u00e3o - ValidaOnLine()"},{"location":"valida_online/#proposito","text":"Retorna o valor de um ou mais campos, a partir do parametro \"StrCampo\".","title":"Prop\u00f3sito"},{"location":"valida_online/#input","text":"String : strSql String : strCampo Optional : cnxConexao","title":"Input"},{"location":"valida_online/#output","text":"Dim curValidaonline As CursorOdbc Dim i As Integer Dim strField As String Dim m_ret As String On Error GoTo TrataErroValidaOnLine ValidaOnLine = \"\" If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If '------------------------------ ' Se existir inconsist\u00eancia no ' comando SQL informado ' deve ser ignorado. '------------------------------ ' HDS46267 - PEDROF - 14/12/2015 - INICIO 'If InStr(strSql, \"= ''\") <> 0 Then ' Exit Function 'End If ' HDS46267 - PEDROF - 14/12/2015 - FIM If IsMissing(cnxConexao) Then Set cnxConexao = CnxPermanente End If Set curValidaonline = cnxConexao.DbOpenCursor(strSql) If curValidaonline.Eof Then curValidaonline.DbCloseCursor Exit Function End If If InStr(strCampo, \",\") > 0 Then For i = 0 To UBound(Split(strCampo, \",\")) strField = Split(strCampo, \",\")(i) If strField <> \"\" Then m_ret = m_ret & Trim(curValidaonline.DbGetData(strField)) & \"|\" End If Next Else m_ret = curValidaonline.DbGetData(strCampo) End If curValidaonline.DbCloseCursor ValidaOnLine = m_ret Exit Function TrataErroValidaOnLine: Set curValidaonline = Nothing Exit Function End Function","title":"Output"}]}